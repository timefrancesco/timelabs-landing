---
import "../styles/global.css";
import { t, locales, type Locale } from "../i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;

const apps = [
  {
    title: "Bitfolio",
    description: t(locale, "apps.bitfolio.description"),
    url: "https://bitfolio.app",
    image: "/images/bitfolio.png",
  },
  {
    title: "NewsNinja",
    description: t(locale, "apps.newsninja.description"),
    url: "https://ainews.ninja",
    image: "/images/newsninja.png",
  },
  {
    title: "iStory",
    description: t(locale, "apps.istory.description"),
    url: "https://istory.timelabs.io",
    image: "/images/istory.png",
  },
];

const canonicalUrl = locale === "en"
  ? "https://timelabs.io/"
  : `https://timelabs.io/${locale}/`;
---

<html lang={locale}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={t(locale, "meta.description")} />
    <meta name="generator" content={Astro.generator} />
    <meta property="og:title" content={t(locale, "meta.title")} />
    <meta property="og:description" content={t(locale, "meta.ogDescription")} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content="https://timelabs.io/images/og-cover.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={t(locale, "meta.title")} />
    <meta name="twitter:description" content={t(locale, "meta.ogDescription")} />
    <meta name="twitter:image" content="https://timelabs.io/images/og-cover.png" />
    <title>{t(locale, "meta.title")}</title>
    <link rel="canonical" href={canonicalUrl} />
    <link rel="alternate" hreflang="en" href="https://timelabs.io/" />
    <link rel="alternate" hreflang="it" href="https://timelabs.io/it/" />
    <link rel="alternate" hreflang="ja" href="https://timelabs.io/ja/" />
    <link rel="alternate" hreflang="x-default" href="https://timelabs.io/" />

    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Organization",
          "name": "Timelabs",
          "url": "https://timelabs.io",
          "logo": "https://timelabs.io/images/og-cover.png",
          "description": "Timelabs builds mobile apps for tracking, reading, and journaling.",
          "contactPoint": {
            "@type": "ContactPoint",
            "email": "support@timelabs.io",
            "contactType": "customer support"
          }
        },
        {
          "@type": "WebSite",
          "name": "Timelabs",
          "url": "https://timelabs.io"
        },
        {
          "@type": "SoftwareApplication",
          "name": "Bitfolio",
          "url": "https://bitfolio.app",
          "applicationCategory": "FinanceApplication",
          "operatingSystem": "iOS, Android",
          "description": t(locale, "apps.bitfolio.description"),
          "author": { "@type": "Organization", "name": "Timelabs" }
        },
        {
          "@type": "SoftwareApplication",
          "name": "NewsNinja",
          "url": "https://ainews.ninja",
          "applicationCategory": "NewsApplication",
          "operatingSystem": "iOS, Android",
          "description": t(locale, "apps.newsninja.description"),
          "author": { "@type": "Organization", "name": "Timelabs" }
        },
        {
          "@type": "SoftwareApplication",
          "name": "iStory",
          "url": "https://istory.timelabs.io",
          "applicationCategory": "PhotographyApplication",
          "operatingSystem": "iOS",
          "description": t(locale, "apps.istory.description"),
          "author": { "@type": "Organization", "name": "Timelabs" }
        }
      ]
    })} />
  </head>
  <body
    class="min-h-screen flex flex-col bg-gradient-main text-gray-800 antialiased"
  >
    <!-- Header -->
    <header class="pt-12 pb-6 sm:pt-20 sm:pb-0 text-center">
      <h1 class="text-5xl sm:text-7xl font-extrabold tracking-tight">Timelabs</h1>
      <p class="mt-3 text-lg text-gray-500">{t(locale, "header.tagline")}</p>
    </header>

    <!-- App Cards -->
    <main class="flex-1 flex items-center justify-center px-4 pb-20">
      <div
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-xs sm:max-w-5xl w-full"
      >
        {
          apps.map((app) => (
            <a
              href={app.url}
              target="_blank"
              rel="noopener noreferrer"
              class="group block rounded-[3.5rem] bg-glass-bg border border-glass-border
                     backdrop-blur-xl shadow-lg
                     p-8 transition-all duration-300
                     hover:bg-glass-bg-hover hover:shadow-2xl hover:scale-[1.02]
                     focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-400"
            >
              <div class="aspect-square rounded-[72px] mb-4 overflow-hidden grid place-items-center">
                <span class="col-start-1 row-start-1 text-5xl font-bold text-gray-400/40">
                  {app.title[0]}
                </span>
                <img
                  src={app.image}
                  alt={`${app.title} app screenshot`}
                  class="col-start-1 row-start-1 w-full h-full object-cover"
                  loading="lazy"
                />
              </div>
              <h2 class="text-xl font-semibold group-hover:text-gray-900">
                {app.title}
              </h2>
              <p class="mt-1 text-sm text-gray-500">{app.description}</p>
            </a>
          ))
        }
      </div>
    </main>

    <!-- Footer -->
    <footer class="py-8 text-center border-t border-black/10">
      <h2
        class="text-sm font-semibold uppercase tracking-wider text-gray-400 mb-2"
      >
        {t(locale, "footer.contactUs")}
      </h2>
      <a
        href="mailto:support@timelabs.io"
        class="text-gray-600 hover:text-gray-900 underline-offset-4 hover:underline transition-colors"
      >
        support@timelabs.io
      </a>
      <p class="mt-4 text-xs text-gray-400">
        &copy; {new Date().getFullYear()} Timelabs. {t(locale, "footer.rights")}
      </p>

      <!-- Language Switcher -->
      <nav class="mt-4 flex items-center justify-center gap-2 text-xs text-gray-400">
        {locales.map((loc, i) => (
          <>
            {i > 0 && <span>Â·</span>}
            {loc.code === locale ? (
              <span class="text-gray-600 font-medium">{loc.label}</span>
            ) : (
              <a
                href={getRelativeLocaleUrl(loc.code)}
                class="hover:text-gray-600 underline-offset-4 hover:underline transition-colors"
              >
                {loc.label}
              </a>
            )}
          </>
        ))}
      </nav>
    </footer>
  </body>
</html>
